<form fxLayout="column"
      fxFlex.gt-lg="30%" fxFlexOffset.gt-lg="35%"
      fxFlex.gt-md="40%" fxFlexOffset.gt-md="30%"
      fxFlex.gt-sm="60%" fxFlexOffset.gt-sm="20%"
      fxFlex.gt-xs="100%" fxFlexOffset.gt-xs="0%"
      [formGroup]="addPropertyForm" (ngSubmit)="onSubmit()">
  <mat-stepper #stepper linear orientation="vertical">
    <mat-step [stepControl]="basicInfo">
      <ng-template matStepLabel>Basic info</ng-template>

      <mat-card fxLayout="column" formGroupName="basicInfo">
        <mat-card-title>Basic info</mat-card-title>

        <mat-form-field appearance="outline">
          <mat-label>Name</mat-label>
          <input matInput type="text" formControlName="name"/>

          <mat-hint align="end">{{ name.value?.length || 0 }}/{{ maxNameLength }}</mat-hint>

          <mat-error>
            <ng-container *ngIf="name.hasError('required')">Name is required!</ng-container>
            <ng-container *ngIf="name.hasError('minlength')">Name must contain at least {{ minNameLength }} characters!</ng-container>
            <ng-container *ngIf="name.hasError('maxlength')">Name must not be longer than {{ maxNameLength }} characters!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>City</mat-label>
          <input matInput type="text" formControlName="city"/>

          <mat-error>
            <ng-container *ngIf="city.hasError('required')">City is required!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Property type</mat-label>

          <mat-select formControlName="propertyType">
            <mat-option *ngFor="let type of propertyTypes" [value]="type">{{ type }}</mat-option>
          </mat-select>

          <mat-error>
            <ng-container *ngIf="propertyType.hasError('required')">Property type is required!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Furnishing type</mat-label>

          <mat-select formControlName="furnishingType">
            <mat-option *ngFor="let type of furnishingTypes" [value]="type">{{ type }}</mat-option>
          </mat-select>

          <mat-error>
            <ng-container *ngIf="furnishingType.hasError('required')">Furnishing type is required!</ng-container>
          </mat-error>
        </mat-form-field>

        <div class="mat-form-field-wrapper">
          <p>BHK</p>

          <mat-button-toggle-group formControlName="BHK">
            <mat-button-toggle fxFlex fxLayout="row" *ngFor="let bhk of [1, 2, 3, 4]" [value]="bhk">{{ bhk }}</mat-button-toggle>
          </mat-button-toggle-group>

          <mat-error>
            <ng-container *ngIf="BHK.hasError('required') && BHK.touched">BHK is required!</ng-container>
            <ng-container *ngIf="BHK.hasError('min')">BHK cannot be less than 1!</ng-container>
          </mat-error>
        </div>

        <div class="mat-form-field-wrapper">
          <p>I want to</p>

          <mat-button-toggle-group formControlName="forSell">
            <mat-button-toggle fxFlex fxLayout="row" [value]="true">Sell</mat-button-toggle>
            <mat-button-toggle fxFlex fxLayout="row" [value]="false">Rent</mat-button-toggle>
          </mat-button-toggle-group>

          <mat-error>
            <ng-container *ngIf="forSell.hasError('required') && forSell.touched">You have to choose what you want to sell or rent!</ng-container>
          </mat-error>
        </div>

        <div fxLayoutAlign="end">
          <button matStepperNext mat-flat-button type="button" color="primary" [disabled]="basicInfo.invalid">
            <span>Next</span>
            <mat-icon inline fxFlexOffset="0.25rem">navigate_next</mat-icon>
          </button>
        </div>
      </mat-card>
    </mat-step>

    <mat-step [stepControl]="pricingAndArea">
      <ng-template matStepLabel>Pricing and area</ng-template>

      <mat-card fxLayout="column" formGroupName="pricingAndArea">
        <mat-card-title>Pricing and area</mat-card-title>

        <mat-form-field appearance="outline">
          <mat-label>Price</mat-label>
          <input matInput type="number" formControlName="price"/>

          <mat-error>
            <ng-container *ngIf="price.hasError('required')">Price is required!</ng-container>
            <ng-container *ngIf="price.hasError('min')">Price cannot be negative!</ng-container>
          </mat-error>
        </mat-form-field>

        <ng-container *ngIf="!forSell.value">
          <mat-form-field appearance="outline">
            <mat-label>Security</mat-label>
            <input matInput type="number" formControlName="security"/>

            <mat-error>
              <ng-container *ngIf="security.hasError('min')">Security cannot be negative!</ng-container>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Maintenance</mat-label>
            <input matInput type="number" formControlName="maintenance"/>

            <mat-error>
              <ng-container *ngIf="maintenance.hasError('min')">Maintenance cannot be negative!</ng-container>
            </mat-error>
          </mat-form-field>
        </ng-container>

        <mat-form-field appearance="outline">
          <mat-label>Built area</mat-label>
          <input matInput type="number" formControlName="builtArea"/>

          <mat-error>
            <ng-container *ngIf="builtArea.hasError('min')">Built area cannot be negative!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Carpet area</mat-label>
          <input matInput type="number" formControlName="carpetArea"/>

          <mat-error>
            <ng-container *ngIf="carpetArea.hasError('required')">Carpet area is required!</ng-container>
            <ng-container *ngIf="carpetArea.hasError('min')">Carpet area cannot be negative!</ng-container>
          </mat-error>
        </mat-form-field>

        <div fxLayoutAlign="space-between">
          <button matStepperPrevious mat-stroked-button type="button">
            <mat-icon inline>navigate_before</mat-icon>
            <span fxFlexOffset="0.25rem">Back</span>
          </button>

          <button matStepperNext mat-flat-button type="button" color="primary" [disabled]="pricingAndArea.invalid">
            <span>Next</span>
            <mat-icon inline fxFlexOffset="0.25rem">navigate_next</mat-icon>
          </button>
        </div>
      </mat-card>
    </mat-step>

    <mat-step [stepControl]="location">
      <ng-template matStepLabel>Location</ng-template>

      <mat-card fxLayout="column" formGroupName="location">
        <mat-card-title>Address</mat-card-title>

        <mat-form-field appearance="outline">
          <mat-label>Address</mat-label>
          <input matInput type="text" formControlName="address"/>

          <mat-error>
            <ng-container *ngIf="address.hasError('required')">Address is required!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Floor</mat-label>
          <input matInput type="number" formControlName="floor"/>

          <mat-error>
            <ng-container *ngIf="floor.hasError('min')">Floor cannot be less than 1!</ng-container>
            <ng-container *ngIf="floor.hasError('max')">Floor cannot be greater than 128!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Total floor</mat-label>
          <input matInput type="number" formControlName="totalFloor"/>

          <mat-error>
            <ng-container *ngIf="totalFloor.hasError('min')">Total floor cannot be less than 1!</ng-container>
            <ng-container *ngIf="totalFloor.hasError('max')">Total floor cannot be greater than 128!</ng-container>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Landmark</mat-label>
          <input matInput type="text" formControlName="landmark"/>
        </mat-form-field>

        <div fxLayoutAlign="space-between">
          <button matStepperPrevious mat-stroked-button type="button">
            <mat-icon inline>navigate_before</mat-icon>
            <span fxFlexOffset="0.25rem">Back</span>
          </button>

          <button matStepperNext mat-flat-button type="button" color="primary" [disabled]="location.invalid">
            <span>Next</span>
            <mat-icon inline fxFlexOffset="0.25rem">navigate_next</mat-icon>
          </button>
        </div>
      </mat-card>
    </mat-step>

    <mat-step [stepControl]="otherDetails">
      <ng-template matStepLabel>Other details</ng-template>

      <mat-card fxLayout="column" formGroupName="otherDetails">
        <mat-card-title>Other details</mat-card-title>

        <div class="mat-form-field-wrapper">
          <p>Ready to move?</p>

          <mat-button-toggle-group formControlName="readyToMove">
            <mat-button-toggle fxFlex fxLayout="row" [value]="true">Yes</mat-button-toggle>
            <mat-button-toggle fxFlex fxLayout="row" [value]="false">No</mat-button-toggle>
          </mat-button-toggle-group>

          <mat-error>
            <ng-container *ngIf="readyToMove.hasError('required') && readyToMove.touched">You have to choose property is ready to move or not!</ng-container>
          </mat-error>
        </div>

        <mat-form-field appearance="outline" *ngIf="readyToMove.value; else notReady">
          <mat-label>Age of property</mat-label>
          <input matInput type="number" formControlName="age"/>

          <mat-error>
            <ng-container *ngIf="age.hasError('min')">Age cannot be negative!</ng-container>
          </mat-error>
        </mat-form-field>

        <ng-template #notReady>
          <mat-form-field appearance="outline">
            <mat-label>Possession</mat-label>
            <input matInput formControlName="possession" [matDatepicker]="picker"/>

            <mat-datepicker #picker></mat-datepicker>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          </mat-form-field>
        </ng-template>

        <div class="mat-form-field-wrapper">
          <p>Gated community</p>

          <mat-button-toggle-group formControlName="gatedCommunity">
            <mat-button-toggle fxFlex fxLayout="row" [value]="true">Yes</mat-button-toggle>
            <mat-button-toggle fxFlex fxLayout="row" [value]="false">No</mat-button-toggle>
          </mat-button-toggle-group>
        </div>

        <div class="mat-form-field-wrapper">
          <p>Main entrance</p>

          <mat-button-toggle-group formControlName="mainEntrance">
            <mat-button-toggle fxFlex fxLayout="row" *ngFor="let side of ['East', 'West', 'South', 'North']" [value]="side">{{ side }}</mat-button-toggle>
          </mat-button-toggle-group>

          <mat-error>
            <ng-container *ngIf="mainEntrance.hasError('required') && mainEntrance.touched">Main entrance is required!</ng-container>
          </mat-error>
        </div>

        <mat-form-field appearance="outline">
          <mat-label>Description</mat-label>
          <textarea matInput type="text" rows="6" formControlName="description"></textarea>

          <mat-hint align="end">{{ description.value?.length || 0 }}/{{ maxDescriptionLength }}</mat-hint>

          <mat-error>
            <ng-container *ngIf="description.hasError('maxlength')">Description must not be longer than {{ maxDescriptionLength }} characters!</ng-container>
          </mat-error>
        </mat-form-field>

        <div fxLayoutAlign="space-between">
          <button matStepperPrevious mat-stroked-button type="button">
            <mat-icon inline>navigate_before</mat-icon>
            <span fxFlexOffset="0.25rem">Back</span>
          </button>

          <button matStepperNext mat-flat-button type="button" color="primary" [disabled]="otherDetails.invalid">
            <span>Next</span>
            <mat-icon inline fxFlexOffset="0.25rem">navigate_next</mat-icon>
          </button>
        </div>
      </mat-card>
    </mat-step>

    <mat-step [stepControl]="photos">
      <ng-template matStepLabel>Photos</ng-template>

      <mat-card fxLayout="column" formGroupName="photos">
        <mat-card-title>Photos</mat-card-title>

        <button mat-stroked-button type="button">
          <mat-icon inline>attach_file</mat-icon>
          <span fxFlexOffset="0.25rem">Choose photos</span>
        </button>

        <div fxLayoutAlign="space-between" fxFlexOffset="1rem">
          <button matStepperPrevious mat-stroked-button type="button">
            <mat-icon inline>navigate_before</mat-icon>
            <span fxFlexOffset="0.25rem">Back</span>
          </button>

          <div fxLayoutGap="1em">
            <button mat-flat-button type="reset" color="warn" (click)="stepper.reset()">
              <mat-icon inline>close</mat-icon>
              <span fxFlexOffset="0.25rem">Reset</span>
            </button>

            <button mat-flat-button type="submit" color="primary" [disabled]="photos.invalid">
              <mat-icon inline>check</mat-icon>
              <span fxFlexOffset="0.25rem">Submit</span>
            </button>
          </div>
        </div>
      </mat-card>
    </mat-step>
  </mat-stepper>
</form>
